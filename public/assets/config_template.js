function snippet_changed(e){var t=!!$(e).attr("checked");$("#kind_selector").toggle(!t),$("#snippet_message").toggle(t),$("#association").toggle(!t)}function create_editor(e){e.parent().prepend("<div id='editor1'></div>"),$("#editor1").css("position","relative").height(e.height()||"360").width(e.width()+10),e.hide(),$editor=ace.edit("editor1"),$editor.setShowPrintMargin(!1),$editor.renderer.setShowGutter(!1)}function set_preview(){$(".template_text").hasClass("diffMode")||($(".template_text").addClass("diffMode"),$("#new").html($editor.getSession().getValue()),set_diff_mode($(".template_text")))}function set_code(){$(".template_text").removeClass("diffMode"),set_edit_mode($(".template_text"))}function set_edit_mode(e){$editor.setTheme("ace/theme/twilight"),$editor.setReadOnly(!1);var t=$editor.getSession();t.setMode("ace/mode/ruby"),t.setValue($("#new").text()),t.on("change",function(){e.text(t.getValue())})}function set_diff_mode(e){$editor.setTheme("ace/theme/clouds"),$editor.setReadOnly(!0);var t=$editor.getSession();t.setMode("ace/mode/diff");var n=JsDiff.createPatch(e.attr("data-file-name"),$("#old").text(),$("#new").text());$(t).off("change"),t.setValue(n)}function IE_diff_mode(e){var t=JsDiff.createPatch(e.attr("data-file-name"),$("#old").contents().text(),$("#new").contents().text());e.val(t),e.attr("readOnly",!0)}function revert_template(e){var t=confirm("You are about to override the editor content with a previous version, Are You Sure?");if(t){var n=$(e).attr("data-version"),i=$(e).attr("data-url");$.ajax({type:"get",url:i,data:"version="+n,complete:function(t){$("#primary_tab").click(),$.browser.msie&&10>$.browser.version.slice(0,1)?$(".template_text").val(t.responseText):($("#new").text(t.responseText),set_edit_mode($(".template_text")));var n=$(e).closest("div.row").find("h6 span").attr("data-original-title");$("#config_template_audit_comment").text("Revert to revision from: "+n)}})}}var $editor;$(function(){var e=$(".template_text");$.browser&&$.browser.msie&&10>$.browser.version.slice(0,1)?($(".subnav").hide(),$(".diffMode").size()>0&&IE_diff_mode(e)):(e.size()>0&&create_editor(e),$(".diffMode").size()>0?set_diff_mode(e):set_edit_mode(e),$("#config_template_submit").on("click",function(){$(".diffMode").size()>0&&set_edit_mode($(".template_text"))})),$(".template_file").on("change",function(e){if(""!=$(".template_file").val())if(window.File&&window.FileList&&window.FileReader){var t=confirm("You are about to override the editor content, Are You Sure?");if(!t)return $(".template_file").val(""),void 0;for(var n,i=e.target.files,a=0;n=i[a];a++){var o=new FileReader;o.onloadend=function(e){e.target.readyState==FileReader.DONE&&($("#new").text(e.target.result),set_edit_mode($(".template_text")))},o.readAsText(n),$(".template_file").val("")}}else $editor.setTheme("ace/theme/clouds"),$editor.setReadOnly(!0)}),$("#keybinding").on("change",function(){var e=require("ace/keyboard/vim").handler,t=require("ace/keyboard/emacs").handler,n={Default:null,Vim:e,Emacs:t};$editor.setKeyboardHandler(n[$("#keybinding").val()])})});